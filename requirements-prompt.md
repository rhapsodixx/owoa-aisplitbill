You are a **seasoned product manager** leveraging **Google Antigravity with Gemini Pro 3** for vibe coding.

Your task is to **design a complete product requirements document** that will be **consumed directly by an AI engineering agent**.

### Core Objective

Create a **mobile-friendly AI-assisted split bill application** with **exactly 2 pages**.
The output **MUST** be written in **Markdown** and saved as **`requirements.md`**.

The requirements must be:

- Explicit
- Deterministic
- Non-ambiguous
- Structured for **LLM consumption**
- Free of assumptions not stated in this prompt
- Suitable for **Google Gemini** as a downstream planning and coding agent

---

## üìå Product Overview

**Product Name (Working Title):** AI Split Bill
**Platform:** Mobile-first Web App
**Primary User Goal:**
Allow users to upload a receipt, describe how food/drinks were consumed, and receive an accurate, fair split of the total bill using AI.

---

## üìÑ Page Structure (STRICT)

The application has **ONLY TWO (2) PAGES**:

---

### **Page 1: Bill Input Page**

This page collects all user inputs required for AI processing.

#### Required Inputs

1. **Receipt Image Upload**

   - Type: File upload
   - Mandatory: YES
   - Accepted formats: JPG, PNG, HEIC, WEBP
   - Purpose: Source of all item prices, taxes, service fees, and totals

2. **Number of People**

   - Type: Number input
   - Mandatory: YES
   - Validation rules:

     - Must be an integer
     - Must be greater than 0
     - Cannot be empty

3. **Extra Instructions**

   - Type: Multiline text input
   - Mandatory: NO
   - Purpose: Provide additional context to the AI for accurate splitting
   - Examples:

     - ‚ÄúPerson A ate noodles and tea‚Äù
     - ‚ÄúPerson B ate fried rice only‚Äù
     - ‚ÄúPerson C shared dessert with Person A‚Äù
     - ‚ÄúOne person ate multiple dishes and drinks‚Äù

#### Page 1 Behavior

- User **cannot proceed** unless:

  - Receipt image is uploaded
  - Number of people is valid

- On submit, all inputs are sent to the AI processing layer

---

### **Page 2: Split Bill Result Page**

This page displays the structured output generated by the AI.

#### Output Requirements

The AI must return data that can be rendered into:

- A **clear per-person breakdown**
- Each person must have:

  - List of food items
  - List of drink items
  - Subtotal before additional fees
  - Allocated tax amount
  - Allocated service fee
  - Final total payable

#### Calculation Rules (MANDATORY)

- All taxes, service fees, and additional charges:

  - MUST be included in the final calculation
  - MUST be distributed **proportionally**, based on the value of food/drinks consumed by each person

- No rounding assumptions unless explicitly stated by the AI
- Final totals must be clearly shown per person

#### Presentation Requirements

- Output must be:

  - Human-readable
  - Structured
  - Visually scannable

- Example sections:

  - Person 1 Summary
  - Person 2 Summary
  - Grand Total (reference)

---

## ü§ñ AI & LLM Configuration

### AI Responsibilities

The AI is responsible for:

- Reading and interpreting receipt image contents
- Extracting item names, prices, taxes, and fees
- Mapping items to individuals based on extra instructions
- Calculating fair cost distribution
- Producing structured, explainable output

### LLM Provider

- **API Gateway:** OpenRouter API

### Models

- **Default Model:** `openai/gpt-4o-mini`
- **Fallback Model:** `google/gemini-2.0-flash-001`

### Configuration Rules

- LLM model selection MUST be configurable via environment variables
- No model identifiers may be hardcoded

#### Required `.env` Variables

```env
OPENROUTER_API_KEY=
OPENROUTER_MODEL_DEFAULT=openai/gpt-4o-mini
OPENROUTER_MODEL_FALLBACK=google/gemini-2.0-flash-001
```

---

## üß† Prompting & Safety Rules

- AI prompts must:

  - Include receipt OCR data
  - Include number of people
  - Include user extra instructions verbatim

- Input must be sanitized to reduce prompt injection risk
- AI output must be deterministic and structured

---

## üéØ Non-Goals (Explicitly Out of Scope)

- User authentication
- User accounts
- History of past bills
- Payments or payment integrations
- More than 2 pages
- Manual editing of extracted receipt items

---

## üì¶ Deliverable Instructions

- Output **ONLY** the contents of `requirements.md`
- Use clean, structured Markdown
- Use headings, bullet points, and tables where appropriate
- Do NOT include explanations outside the document
- Do NOT reference this prompt or Antigravity in the output
